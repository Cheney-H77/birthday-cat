<!doctype html>
<html lang="zh-CN">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Happy 18 • 小猫给你的生日信</title>
<meta name="description" content="给你的18岁：倒计时、会动的小猫、翻卡牌和彩蛋。">
<style>
  /* ===== 颜色与基础排版 ===== */
  :root{--pink:#ff4d6d;--bg1:#fff4f7;--bg2:#fff;--ink:#222;}
  *{box-sizing:border-box} html,body{margin:0}
  body{
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Segoe UI,Roboto,Helvetica,Arial;
    background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--ink)
  }
  .wrap{max-width:860px;margin:0 auto;padding:22px}
  .card{background:#fff;border-radius:22px;box-shadow:0 10px 30px rgba(255,0,80,.08);padding:22px;margin-bottom:16px}
  h1{font-size:26px;margin:6px 0 10px}
  h2{font-size:20px;margin:0 0 10px}
  .sub{opacity:.85}.muted{opacity:.72;font-size:13px}.center{text-align:center}
  .btn{display:inline-block;padding:12px 16px;border-radius:999px;background:var(--pink);color:#fff;font-weight:600;border:none}
  .btn:active{transform:scale(.98)}
  .pill{display:inline-block;background:#ffe5eb;padding:8px 12px;border-radius:999px;margin:6px 8px 0 0;font-size:14px}

  /* ===== 倒计时样式 ===== */
  .count{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin:8px 0}
  .box{min-width:70px;padding:10px 12px;border-radius:12px;background:#fff5f7;border:1px solid #ffd5e0;text-align:center}
  .box b{font-size:20px;display:block}

  /* ===== 照片小猫舞台 ===== */
  .stage{height:260px;position:relative;overflow:hidden}
  .kitty-photo{
    position:absolute;left:50%;top:55%;transform:translate(-50%,-50%);
    width:min(65vw,320px);border-radius:20px;box-shadow:0 10px 20px rgba(0,0,0,.12)
  }
  .kitty-shadow{
    position:absolute;left:50%;top:78%;transform:translateX(-50%);
    width:52%;height:16px;background:radial-gradient(ellipse at center, rgba(0,0,0,.18), rgba(0,0,0,0) 60%);
    filter:blur(6px);opacity:.6
  }
  /* 小表演动作：转圈/跳/跑/抖动（通过加类名触发） */
  .spin {animation:spin .9s ease-in-out}
  @keyframes spin {from{transform:translate(-50%,-50%) rotate(0)} to{transform:translate(-50%,-50%) rotate(360deg)}}
  .jump {animation:jump .7s ease-out}
  @keyframes jump {0%{transform:translate(-50%,-50%)}50%{transform:translate(-50%,-62%)}100%{transform:translate(-50%,-50%)}}
  .runL {animation:runL 1.1s ease-in-out}
  @keyframes runL {0%{left:70%}50%{left:30%}100%{left:50%}}
  .runR {animation:runR 1.1s ease-in-out}
  @keyframes runR {0%{left:30%}50%{left:70%}100%{left:50%}}
  .shake{animation:shake .45s ease-in-out}
  @keyframes shake{0%,100%{transform:translate(-50%,-50%)}25%{transform:translate(calc(-50% - 6px),-50%)}75%{transform:translate(calc(-50% + 6px),-50%)}}

  /* ===== 翻牌网格 ===== */
  .grid18{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
  @media(min-width:640px){.grid18{grid-template-columns:repeat(3,1fr)}}
  .flip{perspective:1000px}
  .card3d{
    position:relative;height:110px;border-radius:16px;transform-style:preserve-3d;transition:transform .6s;
    box-shadow:0 8px 18px rgba(0,0,0,.06);cursor:pointer;background:#fff
  }
  .card3d:hover{transform:translateY(-2px)}
  .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:16px;
        backface-visibility:hidden;font-size:16px}
  .front{background:#ffe8ef}
  .back{transform:rotateY(180deg);background:#fff}
  .flipped .card3d{transform:rotateY(180deg)}

  /* ===== hearts ===== */
  .hearts{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;overflow:hidden}
  .heart{position:absolute;font-size:22px;animation:rise 2.4s ease-out forwards}
  @keyframes rise{from{transform:translateY(0) scale(.6);opacity:1}to{transform:translateY(-120vh) scale(1.2);opacity:0}}
  .footer{margin:16px 0;text-align:center;opacity:.6}
</style>

<div class="wrap">
  <!-- 顶部祝福 + 倒计时 -->
  <div class="card center">
    <div class="sub" id="hi">小可爱，我来啦～</div>

    <!-- 照片猫舞台 -->
    <div class="stage">
      <!-- 使用你的照片。路径：assets/cat.png -->
      <img class="kitty-photo" id="kittyPhoto" src="./assets/cat.png" alt="可爱小猫">
      <div class="kitty-shadow"></div>
    </div>

    <h1 id="title">Happy 18th Birthday 🎂</h1>
    <div class="type" id="type" style="min-height:2.2em;white-space:pre-wrap;font-size:18px;line-height:1.7"></div>

    <!-- 倒计时容器 -->
    <div class="count" id="countdown" aria-live="polite" style="margin-top:10px"></div>

    <div style="margin-top:10px">
      <!-- 彩蛋入口，确保仓库有 /307/index.html -->
      <a class="pill" href="./307/" target="_self">🎁 打开彩蛋</a>
    </div>

    <div class="muted" id="sig" style="margin-top:8px">—— 来自你的某某</div>
  </div>

  <!-- 18 张翻牌（最后一张固定“获得一只小猫”） -->
  <div class="card">
    <h2 class="center">18个小心愿 & 夸夸卡</h2>
    <div class="grid18" id="grid18"></div>
    <div class="muted center" style="margin-top:6px">点任意卡片可翻面～</div>
  </div>

  <!-- 一小段生日诗（可改） -->
  <div class="card">
    <h2>给你的十八岁 · 一小段诗</h2>
    <div style="line-height:1.9;font-size:17px">
      夜色把校道擦得很亮，风经过你发梢；<br>
      我把喜欢藏在口袋里，装作只是路过。<br>
      若世界偶尔太吵，给你一角安静——<br>
      灯影阑珊处，是你步履的回响。<br>
      祝你十八岁，仍在发光，也被温柔照亮。
    </div>
  </div>

  <div class="footer">© <span id="year"></span> For you.</div>
</div>

<!-- hearts 容器 -->
<div class="hearts" id="hearts"></div>

<script>
  /* ===== 1) 可配置项：时间与称呼 ===== */
  const BIRTHDAY = "2025-12-13 00:00:00"; // 浏览器本地时区；可改到时分秒
  const q = new URLSearchParams(location.search);
  const her = q.get("to") || "小可爱";
  const me  = q.get("from") || "—— 来自你的某某";
  document.getElementById("hi").textContent = her + "，我来啦～";
  document.getElementById("sig").textContent = me;
  document.getElementById("year").textContent = new Date().getFullYear();

  /* ===== 2) 18 条卡牌，最后一张固定“获得一只小猫” ===== */
  const WISHES = [
    "愿你永远被温柔以待，也温柔待己。","考试顺利，睡眠香甜，常常笑出酒窝。",
    "一路有人相伴，回头也有星光。","吃喜欢的甜点，不喜欢的烦恼通通拜拜。",
    "永远对世界抱好奇，也对自己抱耐心。","把不安交给我，把可爱留给你。",
    "梦想有方向，脚步有风。","偶尔迷路也没关系，我们一起找回去。",
    "被喜欢的人喜欢，也被自己喜欢。","运动不累，作业不多，老师超nice！",
    "天气刚刚好，口袋装下一整片月光。","照片都好看，镜子更诚实。",
    "旅途一路平安，返程也满载欢喜。","身体健健康康，胃口开开，睡眠满分。",
    "每一天都能遇见一点小惊喜。","不被焦虑追着跑，被温暖拥着走。",
    "愿你所念皆如愿，所行化坦途。","获得一只小猫 🐱"
  ];

  /* ===== 3) 打字机短句 ===== */
  const msg = `今天是你的18岁，我把一只会撒娇的小猫、十八个小心愿，和一个小小彩蛋都装进这个页面里。点点我试试～`;
  const typeEl = document.getElementById("type");
  let i=0; (function type(){ if(i<=msg.length){ typeEl.textContent = msg.slice(0,i++); setTimeout(type,28);} })();

  /* ===== 4) 倒计时：到点改标题并飘爱心 ===== */
  const countdownEl = document.getElementById("countdown");
  function renderCount(){
    const now = new Date();
    const target = new Date(BIRTHDAY.replace(/-/g,'/')); // iOS 兼容
    const diff = target - now;
    if(diff > 0){
      const d = Math.floor(diff/86400000);
      const h = Math.floor((diff%86400000)/3600000);
      const m = Math.floor((diff%3600000)/60000);
      const s = Math.floor((diff%60000)/1000);
      countdownEl.innerHTML = ["天","时","分","秒"].map((u,idx)=> {
        const v=[d,h,m,s][idx]; return `<div class="box"><b>${v}</b>${u}</div>`;
      }).join("");
    }else{
      document.getElementById("title").textContent = "Happy 18! 🎉";
      countdownEl.innerHTML = `<span class="pill">今天是你的主场！</span>`;
      popHearts(18);
    }
  }
  renderCount(); setInterval(renderCount,1000);

  /* ===== 5) 渲染翻牌 ===== */
  const grid = document.getElementById("grid18");
  WISHES.forEach((text,idx)=>{
    const cell = document.createElement("div"); cell.className="flip";
    cell.innerHTML = `
      <div class="card3d">
        <div class="face front">#${idx+1}</div>
        <div class="face back">${text}</div>
      </div>`;
    cell.addEventListener("click", ()=> cell.classList.toggle("flipped"));
    grid.appendChild(cell);
  });

  /* ===== 6) 爱心粒子 ===== */
  const heartsBox = document.getElementById("hearts");
  function popHearts(n=14){
    for(let i=0;i<n;i++){
      const el = document.createElement("div");
      el.className="heart";
      el.textContent=["❤️","🩷","💗","💖"][Math.floor(Math.random()*4)];
      el.style.left=(Math.random()*100)+"vw";
      el.style.bottom="-10vh";
      el.style.animationDelay=(Math.random()*0.6)+"s";
      heartsBox.appendChild(el);
      setTimeout(()=>heartsBox.removeChild(el),2600);
    }
    if(navigator.vibrate) navigator.vibrate(30); // 手机轻震
  }

  /* ===== 7) 照片猫互动：定时表演 + 点击喵叫抖动 ===== */
  const kitty = document.getElementById("kittyPhoto");

  // WebAudio 合成“喵”音（微信需要用户手势后才能启音）
  let audioCtx = null;
  function meow(){
    try{
      if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const ctx = audioCtx;
      const o1 = ctx.createOscillator(), o2 = ctx.createOscillator();
      const g  = ctx.createGain();
      o1.type="triangle"; o2.type="sawtooth";
      o1.frequency.setValueAtTime(440, ctx.currentTime);
      o1.frequency.exponentialRampToValueAtTime(300, ctx.currentTime+0.18);
      o2.frequency.setValueAtTime(660, ctx.currentTime);
      o2.frequency.exponentialRampToValueAtTime(420, ctx.currentTime+0.18);
      g.gain.value = 0.0001;
      g.gain.exponentialRampToValueAtTime(0.22, ctx.currentTime+0.05);
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.30);
      o1.connect(g); o2.connect(g); g.connect(ctx.destination);
      o1.start(); o2.start(); o1.stop(ctx.currentTime+0.34); o2.stop(ctx.currentTime+0.34);
    }catch(_){}
  }

  function doOnce(cls){ kitty.classList.add(cls); setTimeout(()=>kitty.classList.remove(cls), 1000); }
  function randomAct(){
    const acts = ["spin","jump","runL","runR"];
    doOnce(acts[Math.floor(Math.random()*acts.length)]);
  }
  setInterval(randomAct, 4500); // 每 4.5 秒表演一次

  // 点击：喵叫 + 抖动 + 爱心
  kitty.addEventListener("click", ()=>{ meow(); doOnce("shake"); popHearts(12); });
</script>
</html>
