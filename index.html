<!doctype html>
<html lang="zh-CN">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Happy 18 â€¢ å°çŒ«ç»™ä½ çš„ç”Ÿæ—¥ä¿¡</title>
<meta name="description" content="å€’è®¡æ—¶ã€ä¼šåŠ¨çš„å°çŒ«ã€ç¿»å¡ç‰Œã€ç¤¼ç‰©å¼€ç®±å’Œå½©è›‹ã€‚">
<meta property="og:title" content="Happy 18 â€¢ å°çŒ«ç»™ä½ çš„ç”Ÿæ—¥ä¿¡">
<meta property="og:description" content="ç‚¹ç‚¹å°çŒ«ã€å¼€ä¸ªç¤¼ç‰©ï¼Œå†ç¿» 18 å¼ å¡ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï½">
<meta property="og:type" content="website">
<style>
  /* ===== ä¸»é¢˜ï¼ˆå¥¶èŒ¶é‡‘ / ç±³ç™½ / ç²‰ï¼‰ ===== */
  :root{
    --tea:#d4b073; --cream:#fff9f3; --pink:#ff5c8a; --ink:#222; --muted:#7a7a7a;
    --card:#ffffff; --shadow: 0 10px 30px rgba(0,0,0,.08);
    --gradA:#ffe5ec; --gradB:#fff9f3;
  }
  *{box-sizing:border-box} html,body{margin:0} body{
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Segoe UI,Roboto,Helvetica,Arial;
    background:linear-gradient(180deg,var(--cream),#fff);
    color:var(--ink)
  }
  .wrap{max-width:860px;margin:0 auto;padding:22px}
  .card{background:var(--card);border-radius:22px;box-shadow:var(--shadow);padding:22px;margin-bottom:16px}
  h1{font-size:28px;font-weight:700;margin:6px 0 10px}
  h2{font-size:20px;margin:0 0 10px;font-weight:700}
  .sub{opacity:.9}.muted{color:var(--muted);font-size:13px}.center{text-align:center}
  .btn{display:inline-block;padding:12px 16px;border-radius:999px;background:var(--pink);color:#fff;font-weight:700;border:none;transition:transform .08s, box-shadow .08s}
  .btn:active{transform:scale(.95);box-shadow:0 6px 12px rgba(0,0,0,.06)}
  .pill{display:inline-block;background:#ffe5ec;padding:8px 12px;border-radius:999px;margin:6px 8px 0 0;font-size:14px}
  .pill.disabled{opacity:.5;pointer-events:none}

  /* å€’è®¡æ—¶ */
  .count{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin:8px 0}
  .box{min-width:72px;padding:10px 12px;border-radius:12px;background:#fff5f7;border:1px solid #ffd5e0;text-align:center}
  .box b{font-size:20px;display:block}

  /* èˆå°ï¼ˆçŒ« + ç¤¼ç‰©ç›’ï¼‰ */
  .stage{height:300px;position:relative;overflow:hidden;margin-top:6px}
  .kitty{position:absolute;left:50%;top:56%;transform:translate(-50%,-50%);width:min(65vw,320px)}
  .kitty img{width:100%;height:auto;border-radius:20px;box-shadow:0 10px 20px rgba(0,0,0,.12)}
  .kitty-shadow{position:absolute;left:50%;top:80%;transform:translateX(-50%);width:50%;height:16px;background:radial-gradient(ellipse at center, rgba(0,0,0,.18), rgba(0,0,0,0) 60%);filter:blur(6px);opacity:.6}

  /* å¾®äº¤äº’çƒ­ç‚¹ï¼ˆè€³æœµ/å¤´/å°¾å·´ï¼‰ */
  .hot{position:absolute;pointer-events:auto}
  .hot.earL{left:calc(50% - 70px);top:calc(56% - 105px);width:60px;height:60px}
  .hot.earR{left:calc(50% + 10px); top:calc(56% - 105px);width:60px;height:60px}
  .hot.head{left:calc(50% - 80px);top:calc(56% - 60px);width:160px;height:90px}
  .hot.tail{left:calc(50% + 60px);top:calc(56% + 30px);width:90px;height:80px}

  /* å°çŒ«åŠ¨ä½œç±» */
  .spin {animation:spin .9s ease-in-out}
  @keyframes spin {from{transform:translate(-50%,-50%) rotate(0)}to{transform:translate(-50%,-50%) rotate(360deg)}}
  .jump {animation:jump .7s ease-out}
  @keyframes jump {0%{transform:translate(-50%,-50%)}50%{transform:translate(-50%,-62%)}100%{transform:translate(-50%,-50%)}}
  .runL {animation:runL 1.1s ease-in-out}
  @keyframes runL {0%{left:70%}50%{left:30%}100%{left:50%}}
  .runR {animation:runR 1.1s ease-in-out}
  @keyframes runR {0%{left:30%}50%{left:70%}100%{left:50%}}
  .shake{animation:shake .45s ease-in-out}
  @keyframes shake{0%,100%{transform:translate(-50%,-50%)}25%{transform:translate(calc(-50% - 6px),-50%)}75%{transform:translate(calc(-50% + 6px),-50%)}}
  .tail-fast{animation:tailfast .6s linear 3}
  @keyframes tailfast{0%{filter:hue-rotate(0)}100%{filter:hue-rotate(0)}} /* ä»…ä½œå ä½ï¼Œç”¨classè§¦å‘ */

  /* è·‘åŠ¨è„šå° */
  .paw{position:absolute;width:20px;height:20px;opacity:.9;transform:translate(-50%,-50%) rotate(-20deg);animation:pawfade 1.3s ease-out forwards}
  .paw:before,.paw:after{content:"";position:absolute;background:#d3bfa0;border-radius:50%}
  .paw:before{width:10px;height:8px;left:5px;top:8px;border-radius:50%}
  .paw:after{width:4px;height:4px;left:1px;top:0;box-shadow:8px 0 0 #d3bfa0, 14px 3px 0 #d3bfa0, 6px 3px 0 #d3bfa0}
  @keyframes pawfade{from{opacity:.9}to{opacity:0;transform:translate(-50%,-60%) rotate(-20deg)}}

  /* ç¤¼ç‰©ç›’ï¼ˆå‘¼å¸ + å¼€ç›–ï¼‰ */
  .gift{position:absolute;left:10%;bottom:10px;width:110px;height:110px;cursor:pointer}
  .gift .box{position:absolute;inset:18px 0 0 0;background:linear-gradient(180deg,#fff,#f7e8d0);border:2px solid #bfa06a;border-radius:14px;box-shadow:var(--shadow)}
  .gift .ribbon{position:absolute;left:50%;top:18px;width:14px;height:92px;background:#ff8dad;transform:translateX(-50%)}
  .gift .top{position:absolute;left:-10px;right:-10px;top:0;height:28px;background:#f9e6c6;border:2px solid #bfa06a;border-radius:10px;box-shadow:var(--shadow);transform-origin:bottom center}
  .gift.breath{animation:breath 2.2s ease-in-out infinite}
  @keyframes breath{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}
  .gift.open .top{animation:lift .6s ease-out forwards}
  @keyframes lift{to{transform:translateY(-26px) rotate(-12deg)}}

  /* ç¿»ç‰Œç½‘æ ¼ + æ¸å˜ç¾åŒ– + è¿›åº¦æ¡ */
  .topbar{display:flex;justify-content:space-between;align-items:center;margin:10px 0 4px}
  .progress{height:8px;background:#f1e7d6;border-radius:999px;overflow:hidden}
  .progress > div{height:100%;background:linear-gradient(90deg,#ffd3e1,#ff9fb8);width:0%}
  .grid18{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
  @media(min-width:640px){.grid18{grid-template-columns:repeat(3,1fr)}}
  .flip{perspective:1000px}
  .card3d{
    position:relative;height:112px;border-radius:16px;transform-style:preserve-3d;transition:transform .6s;
    box-shadow:0 8px 18px rgba(0,0,0,.06);cursor:pointer;background:var(--card)
  }
  .card3d:hover{transform:translateY(-2px)}
  .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:16px;
        backface-visibility:hidden;font-size:16px}
  .front{background:linear-gradient(180deg,var(--gradA),#fff)}
  .front b{font-size:18px;color:#8a6b3f}
  .back{transform:rotateY(180deg);background:#fff url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2220%22 height=%2220%22><text x=%220%22 y=%2214%22>ğŸ¾</text></svg>') 8px 8px/20px 20px no-repeat}

  /* å¼¹å±‚ */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;padding:16px}
  .modal .inner{background:#fff;border-radius:18px;max-width:460px;width:100%;padding:20px;box-shadow:var(--shadow);text-align:center}
  .modal.show{display:flex}
  .footer{margin:16px 0;text-align:center;color:var(--muted)}
</style>

<div class="wrap">
  <div class="card center">
    <div class="sub" id="hi">å°å¯çˆ±ï¼Œæˆ‘æ¥å•¦ï½</div>

    <div class="stage" id="stage">
      <!-- å°çŒ« -->
      <div class="kitty" id="kitty">
        <img id="kittyImg" src="./assets/cat.png" alt="å¯çˆ±å°çŒ«">
        <div class="kitty-shadow"></div>
      </div>
      <!-- å¾®äº¤äº’çƒ­ç‚¹ -->
      <div class="hot earL"  data-act="ear"></div>
      <div class="hot earR"  data-act="ear"></div>
      <div class="hot head"  data-act="head"></div>
      <div class="hot tail"  data-act="tail"></div>

      <!-- ä¼šå‘¼å¸çš„ç¤¼ç‰©ç›’ï¼ˆç‚¹å‡»å¼€ç›–â†’å½©å¸¦â†’è·³è½¬ /307ï¼‰ -->
      <div class="gift breath" id="gift">
        <div class="top"></div>
        <div class="box"></div>
        <div class="ribbon"></div>
      </div>
    </div>

    <h1 id="title">Happy 18th Birthday ğŸ‚</h1>
    <div id="type" style="min-height:2.2em;white-space:pre-wrap;font-size:18px;line-height:1.8"></div>

    <div class="count" id="countdown" aria-live="polite" style="margin-top:10px"></div>

    <div style="margin-top:10px">
      <a class="pill disabled" id="eggBtn" href="./307/" target="_self" aria-disabled="true">ğŸ å½©è›‹ï¼ˆæœªè§£é”ï¼‰</a>
    </div>

    <div class="muted" id="sig" style="margin-top:8px">â€”â€” æ¥è‡ªä½ çš„æŸæŸ</div>
  </div>

  <!-- ç¿»ç‰Œè¿›åº¦æ¡ + ç½‘æ ¼ -->
  <div class="card">
    <div class="topbar">
      <h2 class="center" style="margin:0">18 ä¸ªå°å¿ƒæ„¿ & å¤¸å¤¸å¡</h2>
      <div class="muted"><span id="progressText">å·²è§£é” 0/18</span></div>
    </div>
    <div class="progress" aria-label="ç¿»ç‰Œè¿›åº¦"><div id="progressBar"></div></div>
    <div class="grid18" id="grid18"></div>
    <div class="muted center" style="margin-top:6px">ç‚¹ä»»æ„å¡ç‰‡å¯ç¿»é¢ï½</div>
  </div>

  <div class="footer">Â© <span id="year"></span> For you.</div>
</div>

<!-- æˆå°±è§£é”å¼¹å±‚ -->
<div class="modal" id="achieveModal" role="dialog" aria-modal="true" aria-label="æˆå°±è§£é”">
  <div class="inner">
    <h2>æˆå°±è§£é”ï¼šå½©è›‹ ğŸ‰</h2>
    <p>ä½ å·²ç¿»å®Œ 18 å¼ å¡ï¼å½©è›‹å·²è§£é”ï½</p>
    <button class="btn" id="goEgg">ç°åœ¨å°±å»çœ‹çœ‹</button>
  </div>
</div>

<!-- çˆ±å¿ƒå±‚ -->
<div class="hearts" id="hearts" style="position:fixed;inset:0;pointer-events:none"></div>

<script>
  /* ===== é…ç½®ä¸çŠ¶æ€ ===== */
  const BIRTHDAY = "2025-12-13 00:00:00";
  const q = new URLSearchParams(location.search);
  const her = q.get("to") || "å°å¯çˆ±";
  const me  = q.get("from") || "â€”â€” æ¥è‡ªä½ çš„æŸæŸ";
  document.getElementById("hi").textContent = her + "ï¼Œæˆ‘æ¥å•¦ï½";
  document.getElementById("sig").textContent = me;
  document.getElementById("year").textContent = new Date().getFullYear();

  const STORAGE = {
    flipped: "bc_flipped_set", // å·²ç¿»å¼€çš„ç´¢å¼•é›†åˆï¼ˆJSON æ•°ç»„ï¼‰
    eggUnlocked: "bc_egg_unlocked"
  };

  /* ===== æ‰“å­—æœºçŸ­å¥ ===== */
  const msg = `ä»Šå¤©æ˜¯ä½ çš„18å²ï¼Œå°çŒ«å‡†å¤‡äº† 18 å¼ å¤¸å¤¸å¡å’Œä¸€ä¸ªç¥ç§˜å½©è›‹ã€‚å…ˆç¿»å‡ å¼ è¯•è¯•ï¼Ÿä¹Ÿå¯ä»¥ç‚¹ç¤¼ç‰©ç›’ç›´æ¥å¼€åœºï½`;
  (function type(){ const el=document.getElementById("type"); let i=0; (function t(){ if(i<=msg.length){ el.textContent=msg.slice(0,i++); setTimeout(t,24);} })(); })();

  /* ===== å€’è®¡æ—¶ & ç”Ÿæ—¥å½“å¤©ç‰¹åˆ«åŠ¨ä½œ ===== */
  const countdownEl = document.getElementById("countdown");
  function dropConfetti(n=160){
    const box=document.getElementById("hearts");
    for(let i=0;i<n;i++){
      const el=document.createElement("div"); el.style.position="absolute";
      el.style.left=(Math.random()*100)+"vw"; el.style.top=(-10+Math.random()*10)+"vh";
      el.style.width="8px"; el.style.height="14px"; el.style.borderRadius="2px"; el.style.opacity=".9";
      el.style.background=["#ff9fb8","#ffd166","#95d5b2","#74c0fc","#f4acb7"][Math.floor(Math.random()*5)];
      el.style.animation="fall 1.8s ease-out forwards"; box.appendChild(el);
      setTimeout(()=>box.removeChild(el), 2000);
    }
  }
  const style=document.createElement("style"); style.textContent=`@keyframes fall{from{transform:translateY(-10vh) rotate(0)}to{transform:translateY(110vh) rotate(720deg)}}`; document.head.appendChild(style);

  function renderCount(){
    const now = new Date();
    const target = new Date(BIRTHDAY.replace(/-/g,'/'));
    const diff = target - now;
    if(diff > 0){
      const d = Math.floor(diff/86400000), h = Math.floor((diff%86400000)/3600000),
            m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
      countdownEl.innerHTML = ["å¤©","æ—¶","åˆ†","ç§’"].map((u,idx)=> {
        const v=[d,h,m,s][idx]; return `<div class="box"><b>${v}</b>${u}</div>`;
      }).join("");
    }else{
      document.getElementById("title").textContent = "Happy 18! ğŸ‰";
      countdownEl.innerHTML = `<span class="pill">ä»Šå¤©æ˜¯ä½ çš„ä¸»åœºï¼</span>`;
      // è¿ç»­è¡¨æ¼”ï¼šè½¬åœˆâ†’è·³â†’å·¦å³è·‘ + åŠ å€å½©å¸¦
      seqAct(["spin","jump","runL","runR"]);
      dropConfetti(260);
    }
  }
  function seqAct(list, i=0){
    if(i>=list.length) return;
    doOnce(list[i]);
    setTimeout(()=>seqAct(list, i+1), 1000);
  }
  renderCount(); setInterval(renderCount,1000);

  /* ===== ç¿»ç‰Œæ¸²æŸ“ + è¿›åº¦æ¡ + æˆå°±è§£é” ===== */
  const WISHES = [
    "æ„¿ä½ æ°¸è¿œè¢«æ¸©æŸ”ä»¥å¾…ï¼Œä¹Ÿæ¸©æŸ”å¾…å·±ã€‚","è€ƒè¯•é¡ºåˆ©ï¼Œç¡çœ é¦™ç”œï¼Œå¸¸å¸¸ç¬‘å‡ºé…’çªã€‚",
    "ä¸€è·¯æœ‰äººç›¸ä¼´ï¼Œå›å¤´ä¹Ÿæœ‰æ˜Ÿå…‰ã€‚","åƒå–œæ¬¢çš„ç”œç‚¹ï¼Œä¸å–œæ¬¢çš„çƒ¦æ¼é€šé€šæ‹œæ‹œã€‚",
    "æ°¸è¿œå¯¹ä¸–ç•ŒæŠ±å¥½å¥‡ï¼Œä¹Ÿå¯¹è‡ªå·±æŠ±è€å¿ƒã€‚","æŠŠä¸å®‰äº¤ç»™æˆ‘ï¼ŒæŠŠå¯çˆ±ç•™ç»™ä½ ã€‚",
    "æ¢¦æƒ³æœ‰æ–¹å‘ï¼Œè„šæ­¥æœ‰é£ã€‚","å¶å°”è¿·è·¯ä¹Ÿæ²¡å…³ç³»ï¼Œæˆ‘ä»¬ä¸€èµ·æ‰¾å›å»ã€‚",
    "è¢«å–œæ¬¢çš„äººå–œæ¬¢ï¼Œä¹Ÿè¢«è‡ªå·±å–œæ¬¢ã€‚","è¿åŠ¨ä¸ç´¯ï¼Œä½œä¸šä¸å¤šï¼Œè€å¸ˆè¶…niceï¼",
    "å¤©æ°”åˆšåˆšå¥½ï¼Œå£è¢‹è£…ä¸‹ä¸€æ•´ç‰‡æœˆå…‰ã€‚","ç…§ç‰‡éƒ½å¥½çœ‹ï¼Œé•œå­æ›´è¯šå®ã€‚",
    "æ—…é€”ä¸€è·¯å¹³å®‰ï¼Œè¿”ç¨‹ä¹Ÿæ»¡è½½æ¬¢å–œã€‚","èº«ä½“å¥å¥åº·åº·ï¼Œèƒƒå£å¼€å¼€ï¼Œç¡çœ æ»¡åˆ†ã€‚",
    "æ¯ä¸€å¤©éƒ½èƒ½é‡è§ä¸€ç‚¹å°æƒŠå–œã€‚","ä¸è¢«ç„¦è™‘è¿½ç€è·‘ï¼Œè¢«æ¸©æš–æ‹¥ç€èµ°ã€‚",
    "æ„¿ä½ æ‰€å¿µçš†å¦‚æ„¿ï¼Œæ‰€è¡ŒåŒ–å¦é€”ã€‚","è·å¾—ä¸€åªå°çŒ« ğŸ±"
  ];
  const grid = document.getElementById("grid18");
  const progressText = document.getElementById("progressText");
  const progressBar = document.getElementById("progressBar");
  const eggBtn = document.getElementById("eggBtn");
  const stored = JSON.parse(localStorage.getItem(STORAGE.flipped) || "[]");
  const opened = new Set(stored);

  function updateProgress(){
    const n = opened.size;
    progressText.textContent = `å·²è§£é” ${n}/18`;
    progressBar.style.width = Math.round(n/18*100)+"%";
    if(n>=18){
      if(!localStorage.getItem(STORAGE.eggUnlocked)){
        // å¼¹å±‚æç¤º & è§£é”æŒ‰é’®
        localStorage.setItem(STORAGE.eggUnlocked, "1");
        showModal("achieveModal");
        unlockEgg();
        // å¯é€‰ï¼šé€šçŸ¥ä½ ï¼ˆéœ€è¦åç«¯æˆ– webhookï¼›ç•™æ¥å£ï¼‰
        // if (WEBHOOK_URL) fetch(WEBHOOK_URL, {method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify({type:"achieve", ts:Date.now(), ua:navigator.userAgent})});
      } else {
        unlockEgg();
      }
    } else {
      lockEgg();
    }
  }
  function lockEgg(){ eggBtn.classList.add("disabled"); eggBtn.setAttribute("aria-disabled","true"); eggBtn.textContent="ğŸ å½©è›‹ï¼ˆæœªè§£é”ï¼‰"; }
  function unlockEgg(){ eggBtn.classList.remove("disabled"); eggBtn.removeAttribute("aria-disabled"); eggBtn.textContent="ğŸ å½©è›‹ï¼ˆå·²è§£é”ï¼‰"; }

  // åˆå§‹è§£é”çŠ¶æ€
  if(localStorage.getItem(STORAGE.eggUnlocked)) unlockEgg();

  // æ¸²æŸ“å¡ç‰‡
  WISHES.forEach((text,idx)=>{
    const cell = document.createElement("div"); cell.className="flip";
    const isOpen = opened.has(idx);
    cell.innerHTML = `
      <div class="card3d ${isOpen?'flipped':''}">
        <div class="face front"><b>#${idx+1}</b></div>
        <div class="face back">${text}</div>
      </div>`;
    cell.addEventListener("click", ()=>{
      const card = cell.firstElementChild;
      const wasOpen = card.classList.toggle("flipped");
      if(wasOpen){ opened.add(idx); } else { opened.delete(idx); }
      localStorage.setItem(STORAGE.flipped, JSON.stringify([...opened]));
      updateProgress();
    });
    grid.appendChild(cell);
  });
  updateProgress();

  // æˆå°±å¼¹å±‚
  document.getElementById("goEgg").onclick = ()=> location.href="./307/";
  function showModal(id){ document.getElementById(id).classList.add("show"); }
  document.getElementById("achieveModal").addEventListener("click", e=>{ if(e.target.id==="achieveModal") e.currentTarget.classList.remove("show"); });

  /* ===== å°çŒ«äº’åŠ¨ï¼ˆè€³æœµ/å¤´/å°¾å·´ + å®šæ—¶åŠ¨ä½œ + è„šå°ï¼‰ ===== */
  const kitty = document.getElementById("kitty");
  const kittyImg = document.getElementById("kittyImg");
  const stage = document.getElementById("stage");

  // WebAudioï¼šå–µ + å‘¼å™œ
  let audioCtx = null;
  function ensureCtx(){ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); return audioCtx; }
  function meow(){ try{
    const ctx=ensureCtx(), o1=ctx.createOscillator(), o2=ctx.createOscillator(), g=ctx.createGain();
    o1.type="triangle"; o2.type="sawtooth"; o1.frequency.setValueAtTime(440, ctx.currentTime);
    o1.frequency.exponentialRampToValueAtTime(300, ctx.currentTime+0.18);
    o2.frequency.setValueAtTime(660, ctx.currentTime);
    o2.frequency.exponentialRampToValueAtTime(420, ctx.currentTime+0.18);
    g.gain.value=0.0001; g.gain.exponentialRampToValueAtTime(0.22,ctx.currentTime+0.05);
    g.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+0.30);
    o1.connect(g); o2.connect(g); g.connect(ctx.destination); o1.start(); o2.start();
    o1.stop(ctx.currentTime+0.34); o2.stop(ctx.currentTime+0.34);
  }catch{}}
  function purr(ms=700){ try{
    const ctx=ensureCtx(), o=ctx.createOscillator(), g=ctx.createGain();
    o.type="sawtooth"; o.frequency.value=60; g.gain.value=0.0001;
    g.gain.linearRampToValueAtTime(0.08,ctx.currentTime+0.1);
    g.gain.linearRampToValueAtTime(0.0001,ctx.currentTime+ms/1000);
    o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime+ms/1000);
  }catch{}}

  function doOnce(cls){ kitty.classList.add(cls); setTimeout(()=>kitty.classList.remove(cls), 1000); }
  function randomAct(){
    const acts = ["spin","jump","runL","runR"];
    const a = acts[Math.floor(Math.random()*acts.length)];
    doOnce(a);
  }
  setInterval(randomAct, 10000); // æ¯ 10 ç§’è‡ªåŠ¨ä¸€æ¬¡

  // è·‘åŠ¨è„šå°ï¼šåœ¨èˆå°é‡Œæ’’ 3~5 ä¸ª
  function paws(){
    const n = 3 + Math.floor(Math.random()*3);
    for(let i=0;i<n;i++){
      const p = document.createElement("div");
      p.className="paw";
      p.style.left = (40 + Math.random()*20) + "%";
      p.style.top  = (65 + Math.random()*10) + "%";
      stage.appendChild(p); setTimeout(()=>stage.removeChild(p), 1300);
    }
  }

  // çƒ­ç‚¹äº¤äº’
  function shake(){ doOnce("shake"); }
  document.querySelectorAll(".hot").forEach(h=> {
    const act = h.dataset.act;
    h.addEventListener("click", ()=>{
      if(act==="ear"){ shake(); }            // è€³æœµæŠ–ä¸¤ä¸‹ï¼ˆç”¨ shake è¡¨è¾¾ï¼‰
      if(act==="tail"){ doOnce("tail-fast"); } // å°¾å·´åŠ é€Ÿï¼ˆclass å ä½ï¼Œä¾¿äºæ¢æˆåˆ†å±‚å›¾æ—¶æ¢åŠ¨ç”»ï¼‰
      if(act==="head"){ meow(); shake(); }   // è½»ç‚¹å¤´ï¼šå–µ + æŠ–
    });
    // å¤´ï¼šé•¿æŒ‰å‘¼å™œ + é—­çœ¼ï¼ˆç”¨ shake ä»£æ›¿é—­çœ¼å ä½ï¼‰
    if(act==="head"){
      let t=null;
      h.addEventListener("touchstart",()=>{ t=setTimeout(()=>{ purr(900); shake(); }, 450); });
      ["touchend","touchcancel","mouseleave","mouseup"].forEach(ev=> h.addEventListener(ev,()=>{ clearTimeout(t); }));
    }
  });

  // ç‚¹å‡»å°çŒ«æ•´ä½“ï¼šå–µ + æŠ–åŠ¨ + å½©å¿ƒ
  kittyImg.addEventListener("click", ()=>{ meow(); doOnce("shake"); popHearts(10); });

  // å½“ run åŠ¨ä½œæ—¶æ’’è„šå°
  ["animationstart","animationend"].forEach(ev=>{
    kitty.addEventListener(ev, e=>{
      if(e.type==="animationstart" && (kitty.classList.contains("runL")||kitty.classList.contains("runR"))) paws();
    });
  });

  /* ===== ä¼šå‘¼å¸çš„ç¤¼ç‰©ç›’ï¼šç‚¹å‡»å¼€ç›–â†’å½©å¸¦â†’è·³è½¬ /307 ===== */
  const gift = document.getElementById("gift");
  gift.addEventListener("click", ()=>{
    gift.classList.remove("breath");
    gift.classList.add("open");
    dropConfetti(120);
    setTimeout(()=> location.href="./307/", 700);
  });

  /* ===== çˆ±å¿ƒ ===== */
  function popHearts(n=14){
    const box=document.getElementById("hearts");
    for(let i=0;i<n;i++){
      const el=document.createElement("div");
      el.textContent=["â¤ï¸","ğŸ©·","ğŸ’—","ğŸ’–"][Math.floor(Math.random()*4)];
      el.style.position="absolute"; el.style.left=(Math.random()*100)+"vw"; el.style.bottom="-10vh";
      el.style.animation=`rise 2.4s ease-out forwards`; box.appendChild(el);
      setTimeout(()=>box.removeChild(el),2600);
    }
  }
  const s2=document.createElement("style"); s2.textContent=`@keyframes rise{from{transform:translateY(0) scale(.6);opacity:1}to{transform:translateY(-120vh) scale(1.2);opacity:0}}`; document.head.appendChild(s2);
</script>
</html>

