<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Happy 18 â€¢ ç»™å°å–µçš„ç”Ÿæ—¥ä¿¡</title>
<style>
  /* ===== 1. å…¨å±€ä¸»é¢˜ä¸å­—ä½“ ===== */
  :root{
    --tea: #d4b073; 
    --pink: #ff5c8a; 
    --ink: #4a4a4a;
    --glass: rgba(255, 255, 255, 0.65);
    --glass-border: rgba(255, 255, 255, 0.8);
    --shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
  }
  
  *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
  html,body{margin:0; padding:0; height: 100%;}
  
  body{
    font-family: -apple-system, "SF Pro Text", "PingFang SC", "å¾®è½¯é›…é»‘", sans-serif;
    color: var(--ink);
    background: #fff9f3;
    overflow-x: hidden;
    padding-bottom: 60px;
    position: relative;
  }

  /* æ°›å›´èƒŒæ™¯ */
  .ambient-light {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    z-index: -1; pointer-events: none; overflow: hidden;
  }
  .orb {
    position: absolute; border-radius: 50%;
    filter: blur(60px); opacity: 0.6;
    animation: float 20s infinite ease-in-out alternate;
  }
  .orb-1 { width: 300px; height: 300px; background: #ffe5ec; top: -50px; left: -50px; animation-delay: 0s; }
  .orb-2 { width: 250px; height: 250px; background: #fff3d6; bottom: 10%; right: -50px; animation-delay: -5s; }
  
  @keyframes float {
    0% { transform: translate(0, 0) scale(1); }
    100% { transform: translate(40px, 60px) scale(1.1); }
  }

  /* ä¸»å®¹å™¨ */
  .wrap{max-width:860px;margin:0 auto;padding:20px}
  
  .card{
    position: relative;
    background: var(--glass);
    backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-radius: 24px;
    box-shadow: var(--shadow);
    padding: 24px; margin-bottom: 20px;
    transition: transform 0.2s;
  }

  /* ä¿®å¤æ–‡å­—è¢«é®æŒ¡ï¼šå¢åŠ æ ‡é¢˜çš„å±‚çº§ */
  h1 {
    position: relative; z-index: 5; /* å…³é”®ï¼šè®©æ–‡å­—æµ®åœ¨çŒ«çš„ä¸‹æ–¹å±‚çº§ä¹‹ä¸Š */
    font-size: 26px; font-weight: 800; margin: 10px 0 14px; text-align: center;
    background: linear-gradient(135deg, #d4b073 0%, #b89255 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    letter-spacing: -0.5px;
  }
  h2 { font-size: 18px; color: #8a6b3f; text-align: center; margin-bottom: 12px; }

  .sub { text-align: center; font-size: 15px; color: #888; margin-bottom: 10px; }
  .center { text-align: center; }

  /* æŒ‰é’®ä¸æ ‡ç­¾ */
  .pill {
    display: inline-block; background: #fff; color: var(--pink);
    padding: 8px 16px; border-radius: 99px; font-size: 14px; font-weight: 600;
    box-shadow: 0 4px 10px rgba(255, 92, 138, 0.15); text-decoration: none;
    transition: all 0.2s;
  }
  .pill.disabled { background: #f0f0f0; color: #ccc; box-shadow: none; pointer-events: none; }
  
  .btn {
    background: linear-gradient(135deg, #ff9fb8, #ff5c8a);
    color: #fff; padding: 12px 24px; border-radius: 99px; border: none;
    font-size: 16px; font-weight: 700; box-shadow: 0 8px 20px rgba(255, 92, 138, 0.3);
    transition: transform 0.1s;
  }
  .btn:active { transform: scale(0.96); }

  /* å€’è®¡æ—¶ */
  .count { display: flex; justify-content: center; gap: 8px; margin: 16px 0; }
  .box {
    background: rgba(255,255,255,0.7); border: 1px solid rgba(255,255,255,0.9);
    padding: 8px 10px; border-radius: 14px; min-width: 60px; text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.03);
  }
  .box b { font-size: 18px; color: var(--pink); display: block; }
  .box span { font-size: 11px; color: #999; font-weight: 600; letter-spacing: 1px; }

  /* ===== èˆå°ï¼ˆçŒ«ï¼‰ä¿®æ­£ç‰ˆ ===== */
  .stage { height: 260px; position: relative; cursor: pointer; user-select: none; margin-bottom: 10px; }
  
  /* ä¿®å¤çŒ«å¤ªå¤§ï¼šç¼©å°å®½åº¦ï¼Œè°ƒæ•´ top */
  .kitty-wrap {
    position: absolute; left: 50%; 
    top: 52%; /* ç¨å¾®å¾€ä¸Šæä¸€ç‚¹ */
    transform: translate(-50%, -50%);
    width: min(55vw, 220px); /* ä¹‹å‰æ˜¯ 65vw, 280pxï¼Œç°åœ¨æ”¹å° */
    z-index: 2;
    transition: transform 0.1s;
  }
  
  .kitty-img {
    width: 100%; height: auto; display: block;
    animation: breathe 3s ease-in-out infinite;
    filter: drop-shadow(0 8px 15px rgba(0,0,0,0.1));
    border-radius: 20px; /* å¦‚æœä½ æ˜¯æ–¹å›¾æ²¡å»èƒŒæ™¯ï¼Œè¿™ä¸ªåœ†è§’èƒ½ç¨å¾®å¥½çœ‹ç‚¹ */
  }
  
  .shadow {
    position: absolute; left: 50%; top: 82%; transform: translateX(-50%);
    width: 40%; height: 16px; background: radial-gradient(rgba(0,0,0,0.1), transparent 70%);
    animation: shadow-breathe 3s ease-in-out infinite;
  }

  @keyframes breathe { 0%,100%{transform:scale(1)} 50%{transform:scale(1.02, 0.98)} }
  @keyframes shadow-breathe { 0%,100%{opacity:0.6; transform:translateX(-50%) scale(1)} 50%{opacity:0.8; transform:translateX(-50%) scale(1.1)} }

  /* äº¤äº’åŠ¨ä½œ */
  .act-jump { animation: jump 0.5s cubic-bezier(0.17, 0.67, 0.6, 1); }
  @keyframes jump { 0%{top:52%} 50%{top:38%} 100%{top:52%} }
  
  .act-shake .kitty-img { animation: shake 0.4s ease-in-out; }
  @keyframes shake { 0%,100%{transform:rotate(0)} 25%{transform:rotate(-8deg)} 75%{transform:rotate(8deg)} }

  /* ===== ç¿»ç‰ŒåŒºåŸŸ ===== */
  .grid18 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; }
  .card3d { position: relative; aspect-ratio: 0.8; perspective: 1000px; cursor: pointer; }
  .card-inner {
    position: relative; width: 100%; height: 100%; text-align: center;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d; border-radius: 16px;
    box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  }
  .card3d.flipped .card-inner { transform: rotateY(180deg); }

  .face {
    position: absolute; inset: 0; backface-visibility: hidden;
    display: flex; align-items: center; justify-content: center;
    border-radius: 16px; padding: 6px; -webkit-backface-visibility: hidden;
  }
  .front {
    background: #fff;
    background-image: radial-gradient(circle at center, #fff9f3 0%, #fff 100%);
    border: 2px solid #fff;
  }
  .front b { font-size: 20px; color: #e0d0b8; font-family: "Georgia", serif; }
  .back {
    background: #fff; transform: rotateY(180deg);
    border: 2px solid #ffe5ec; color: #555; font-size: 13px; line-height: 1.4; padding: 10px;
    display: flex; align-items: center; justify-content: center;
  }

  /* éŸ³ä¹æŒ‰é’® */
  .music-btn {
    position: fixed; right: 20px; bottom: 30px; width: 48px; height: 48px;
    background: #fff; border-radius: 50%; box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    z-index: 100; display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: transform 0.1s;
  }
  .music-btn:active { transform: scale(0.9); }
  .music-btn.playing svg { animation: spin 3s linear infinite; color: var(--pink); }
  @keyframes spin { 100%{transform:rotate(360deg)} }

  .particles { position: fixed; inset: 0; pointer-events: none; z-index: 999; }
  
  /* å¼¹çª— */
  .modal {
    position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px);
    display: none; align-items: center; justify-content: center; z-index: 2000; padding: 30px;
  }
  .modal.show { display: flex; animation: fadeIn 0.3s; }
  .inner { background: #fff; padding: 30px; border-radius: 24px; text-align: center; width: 100%; max-width: 340px; }
  @keyframes fadeIn { from{opacity:0} to{opacity:1} }
</style>
</head>
<body>

<div class="ambient-light">
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
</div>

<div class="wrap">
  <div class="card center">
    <div class="sub" id="hi">Hi å°å–µï¼Œ18å²ç”Ÿæ—¥å¿«ä¹å“¦ï½</div>

    <div class="stage" id="stage">
      <div class="kitty-wrap" id="kittyWrap">
        <img class="kitty-img" src="./assets/cat.png" alt="å¯çˆ±å°çŒ«">
      </div>
      <div class="shadow"></div>
    </div>

    <h1 id="title">Happy 18th Birthday</h1>
    <div id="type" style="min-height:42px; font-size:15px; color:#666; margin: 0 10px; line-height:1.6;"></div>

    <div class="count" id="countdown"></div>
    
    <div style="margin-top:18px">
      <a class="pill disabled" id="eggBtn" href="./307/" target="_self">ğŸ å½©è›‹ï¼ˆæ”¶é›†è¿›åº¦ 0/18ï¼‰</a>
    </div>
  </div>

  <div class="card">
    <h2 style="display:flex;align-items:center;justify-content:center;gap:6px;">
      <span>âœ¨</span> 18 å¼ å°å¡ç‰Œ <span>âœ¨</span>
    </h2>
    <div class="center muted" style="font-size:13px; color:#999; margin-bottom:15px">
      ç‚¹äº®æ‰€æœ‰å¡ç‰‡ï¼Œè§£é”ç¥ç§˜ç¤¼ç‰©
    </div>
    <div class="grid18" id="grid18"></div>
    <div class="center" style="margin-top:24px">
      <button class="btn" id="randBtn">âœ¨ å¸®æˆ‘ç¿»ä¸€å¼ </button>
    </div>
  </div>

  <div class="center muted" style="margin-top:20px; font-size:12px; opacity:0.6;">
    Â© 2025 For You.
  </div>
</div>

<div class="music-btn" id="musicBtn">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="color:#ccc; transition:color 0.3s">
    <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
  </svg>
  <audio id="bgm" loop>
    <source src="./assets/bgm.mp3" type="audio/mpeg">
  </audio>
</div>

<div class="particles" id="particles"></div>
<div class="modal" id="achieveModal">
  <div class="inner">
    <h2 style="color:var(--pink)">ğŸ‰ æˆå°±è¾¾æˆï¼</h2>
    <p style="color:#666; margin: 16px 0 24px; line-height:1.6">18 å¼ å¡ç‰‡å…¨éƒ¨ç‚¹äº®å•¦<br>å¿«å»çœ‹çœ‹æ˜¯ä»€ä¹ˆç¤¼ç‰©å‘¢ï¼Ÿ</p>
    <button class="btn" onclick="location.href='./307/'" style="width:100%">å‰å¾€å½©è›‹æˆ¿é—´ ğŸ‘‰</button>
  </div>
</div>

<script>
  /* ===== ä¿®å¤ NaN é—®é¢˜ï¼šiOS æ—¥æœŸå¤„ç† ===== */
  // æ ¸å¿ƒä¿®å¤ï¼šä¸ä½¿ç”¨ new Date("2025-12-13")ï¼Œè€Œæ˜¯æ‰‹åŠ¨æ‹¼æ¥å¸¦æ–œæ çš„å­—ç¬¦ä¸²
  const now = new Date();
  const currentYear = now.getFullYear();
  // ç›®æ ‡æœˆä»½ï¼ˆ0-11ï¼‰: 11ä»£è¡¨12æœˆ
  // ç›®æ ‡æ—¥æœŸ: 13
  const targetMonth = 11; 
  const targetDay = 13;

  let birthdayYear = currentYear;
  // å¦‚æœå½“å‰æ—¶é—´å·²ç»æ™šäºä»Šå¹´çš„12æœˆ13æ—¥ï¼Œå°±ç®—æ˜å¹´çš„
  const thisYearBirthday = new Date(currentYear, targetMonth, targetDay);
  if (now > thisYearBirthday) {
    birthdayYear = currentYear + 1;
  }

  // æœ€ç»ˆç”Ÿæˆå­—ç¬¦ä¸² "2025/12/13 00:00:00" <- iOS å®Œç¾æ”¯æŒæ–œæ 
  const BIRTHDAY_DATE = new Date(`${birthdayYear}/${targetMonth + 1}/${targetDay} 00:00:00`);

  /* ================= æ–‡æ¡ˆé…ç½® ================= */
  const WISHES = [
    "æ„¿å°å–µæ°¸è¿œè¢«æ¸©æŸ”ä»¥å¾…", "åœ¨18å²çš„æ™šä¸Š<br>æ€è€ƒä¸€ä¸‹<br>â€œæˆ‘æƒ³æˆä¸ºä¸€ä¸ªä»€ä¹ˆæ ·çš„äººâ€", "ä¸€æœµç«ç‘°æ­£é©¬ä¸åœè¹„åœ°<br>å˜æˆå¦ä¸€æœµç«ç‘°ï¼Œ<br>ä½ æ˜¯äº‘ã€æ˜¯æµ·ã€æ˜¯å¿˜å´ï¼Œ<br>ä½ ä¹Ÿæ˜¯ä½ æ›¾ç»å¤±å»çš„<br>æ¯ä¸€ä¸ªè‡ªå·±ã€‚",
    "The world may be full of cheating<br>however<br>we never lack friends with a sincere heart", "æ‰€æœ‰çš„é’æ˜¥éƒ½åƒä¸€ç›ç¯<br>åœ¨é›¨ä¸­è¢«å†²å€’<br>æ¹¿æ¼‰æ¼‰å´åœ¨ç‡ƒçƒ§", "å¶å°”è¿·è·¯ä¹Ÿæ²¡å…³ç³»",
    "ç»™æˆå¹´çš„è‡ªå·±ï¼Œå†™ä¸€å¼ æ„¿æœ›æ¸…å•", "Tragedy and delight<br>hand in hand.", "è®©è‡ªå·±ç™»åŸº<br>åšé£çš„å›ç‹",
    "ä»Šæ™šæˆ‘ä¸å…³å¿ƒäººç±»ï¼Œæˆ‘åªæƒ³ä½ ", "ä¸–é—´ä¸‡èˆ¬ï¼Œæ°¸è¿œä¿æŒä¸€é¢—è—æ»¡è¯—çš„å¿ƒ", "æˆä¸ºå……æ»¡çƒ­çˆ±ä¸å¥½å¥‡çš„å­©å­<br>æˆä¸ºç»ˆèº«å­¦ä¹ çš„æ™ºè€…",
    "Are you still there?<br>Always!", "ä½ ç³å­”é‡Œä¸€æ± ç¢è£‚çš„æ¸…è¾‰<br>ä¸€ç¥æƒŠé¸¿éš¾å¿˜<br>ä»æ­¤èŠ³åä¹±æµ®ç”Ÿ", "æ— è®ºä¸–ç•Œå¦‚ä½•å®šä¹‰<br>ä½ æ°¸è¿œæ˜¯æœ€æ£’çš„ï¼",
    "æ—¢è§å›å­ï¼Œäº‘èƒ¡ä¸å–œ", "æ—¢è§ä½³äººï¼Œä½•å…¶ä¸æ‚¦", "å½­ç‰å›ï¼Œåå…«å²ç”Ÿæ—¥å¿«ä¹ï¼"
  ];

  /* ================= é€»è¾‘åŒº ================= */
  const kittyWrap = document.getElementById('kittyWrap');
  const stage = document.getElementById('stage');
  const musicBtn = document.getElementById('musicBtn');
  const bgm = document.getElementById('bgm');
  const particles = document.getElementById('particles');

  /* --- éŸ³ä¹æ§åˆ¶ --- */
  let isPlaying = false;
  function toggleMusic(){
    if(isPlaying){ bgm.pause(); musicBtn.classList.remove('playing'); }
    else { bgm.play().catch(()=>{}); musicBtn.classList.add('playing'); }
    isPlaying = !isPlaying;
  }
  musicBtn.addEventListener('click', toggleMusic);
  document.body.addEventListener('click', function first(){
    if(!isPlaying) toggleMusic();
    document.body.removeEventListener('click', first);
  }, {once:true});

  /* --- ç²’å­ç‰¹æ•ˆ --- */
  function popParticles(x, y, count=12){
    for(let i=0; i<count; i++){
      const el = document.createElement('div');
      el.innerText = ['â¤ï¸','âœ¨','ğŸŒ¸','ğŸ€','ğŸ‚'][Math.floor(Math.random()*5)];
      el.style.position = 'fixed';
      el.style.left = x + 'px'; el.style.top = y + 'px';
      el.style.fontSize = (12 + Math.random()*14) + 'px';
      el.style.pointerEvents = 'none';
      el.style.transition = 'transform 1s ease-out, opacity 1s ease-out';
      particles.appendChild(el);
      const angle = Math.random() * 2 * Math.PI;
      const dist = 60 + Math.random() * 80;
      const tx = Math.cos(angle) * dist;
      const ty = Math.sin(angle) * dist - 60;
      requestAnimationFrame(()=>{
        el.style.transform = `translate(${tx}px, ${ty}px) rotate(${Math.random()*180}deg)`;
        el.style.opacity = '0';
      });
      setTimeout(()=> el.remove(), 1000);
    }
  }

  stage.addEventListener('click', (e)=>{
    const acts = ['act-jump', 'act-shake'];
    const cls = acts[Math.floor(Math.random()*acts.length)];
    kittyWrap.classList.add(cls);
    setTimeout(()=> kittyWrap.classList.remove(cls), 600);
    popParticles(e.clientX, e.clientY, 15);
    if(navigator.vibrate) navigator.vibrate(30);
  });

  const grid = document.getElementById('grid18');
  const eggBtn = document.getElementById('eggBtn');
  const KEY_FLIPPED = 'bc_flipped_v2';
  const KEY_UNLOCKED = 'bc_egg_unlocked_v2';
  let flippedSet = new Set();
  try{ flippedSet = new Set(JSON.parse(localStorage.getItem(KEY_FLIPPED)) || []); }catch{}

  WISHES.forEach((txt, i) => {
    const cell = document.createElement('div');
    cell.className = `card3d ${flippedSet.has(i)?'flipped':''}`;
    cell.innerHTML = `<div class="card-inner"><div class="face front"><b>${i+1}</b></div><div class="face back">${txt}</div></div>`;
    cell.addEventListener('click', (e)=>{
      popParticles(e.clientX, e.clientY, 6);
      if(cell.classList.contains('flipped')){
        cell.classList.remove('flipped'); flippedSet.delete(i);
      } else {
        cell.classList.add('flipped'); flippedSet.add(i);
      }
      localStorage.setItem(KEY_FLIPPED, JSON.stringify([...flippedSet]));
      checkProgress();
    });
    grid.appendChild(cell);
  });

  function checkProgress(){
    const n = flippedSet.size;
    const isUnlocked = localStorage.getItem(KEY_UNLOCKED);
    eggBtn.textContent = (n>=18 || isUnlocked) ? "ğŸ å½©è›‹å·²è§£é” (ç‚¹æˆ‘è¿›å…¥)" : `ğŸ å½©è›‹ï¼ˆæ”¶é›†è¿›åº¦ ${n}/18ï¼‰`;
    if(n>=18){
      if(!isUnlocked){
        localStorage.setItem(KEY_UNLOCKED, '1');
        document.getElementById('achieveModal').classList.add('show');
        const w=window.innerWidth, h=window.innerHeight;
        for(let k=0;k<5;k++) setTimeout(()=> popParticles(w/2, h/2, 20), k*200);
      }
      eggBtn.classList.remove('disabled');
    } else {
      if(isUnlocked) eggBtn.classList.remove('disabled');
      else eggBtn.classList.add('disabled');
    }
  }
  checkProgress();

  document.getElementById('randBtn').onclick = (e) => {
    const unflip = [];
    for(let i=0; i<18; i++) if(!flippedSet.has(i)) unflip.push(i);
    if(unflip.length > 0){
      const idx = unflip[Math.floor(Math.random()*unflip.length)];
      grid.children[idx].click();
      grid.children[idx].scrollIntoView({behavior:'smooth', block:'center'});
    } else {
      popParticles(e.clientX, e.clientY, 10);
      alert("å…¨éƒ½ç¿»å¼€å•¦ï¼å¿«å»ç‚¹å½©è›‹å§ï¼");
    }
  }

  /* å€’è®¡æ—¶ä¿®æ­£ç‰ˆ */
  function updateTimer(){
    const diff = BIRTHDAY_DATE - new Date();
    const el = document.getElementById('countdown');
    if(diff <= 0){
      el.innerHTML = `<div class="pill">ğŸ‚ Happy Birthday!</div>`;
      return;
    }
    const d=Math.floor(diff/86400000), h=Math.floor((diff%86400000)/3600000), 
          m=Math.floor((diff%3600000)/60000), s=Math.floor((diff%60000)/1000);
    el.innerHTML = `
      <div class="box"><b>${d}</b><span>DAYS</span></div>
      <div class="box"><b>${h}</b><span>HRS</span></div>
      <div class="box"><b>${m}</b><span>MIN</span></div>
      <div class="box"><b>${s}</b><span>SEC</span></div>
    `;
  }
  setInterval(updateTimer, 1000); updateTimer();

  const msg = "ä»Šå¤©æ˜¯ä½ çš„18å²ç”Ÿæ—¥ã€‚ç¿»å¼€ä¸‹é¢ 18 å¼ å¡ç‰‡ï¼Œæ”¶é›†ç¥ç¦å§ï¼";
  let i_type = 0;
  const tEl = document.getElementById('type');
  function type(){
    if(i_type < msg.length){
      tEl.textContent += msg.charAt(i_type++);
      setTimeout(type, 80);
    }
  }
  setTimeout(type, 600);
</script>
</body>
</html>
