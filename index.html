<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Happy 18 â€¢ å°çŒ«ç»™ä½ çš„ç”Ÿæ—¥ä¿¡</title>
<style>
  /* ===== ä¸»é¢˜é…ç½® ===== */
  :root{
    --tea:#d4b073; --cream:#fff9f3; --pink:#ff5c8a; --ink:#222; --muted:#7a7a7a;
    --card:#ffffff; --shadow: 0 10px 30px rgba(0,0,0,.06);
  }
  *{box-sizing:border-box} html,body{margin:0} body{
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","å¾®è½¯é›…é»‘",Roboto,Arial;
    background:linear-gradient(180deg,var(--cream),#fff);
    color:var(--ink); padding-bottom: 40px;
  }
  .wrap{max-width:860px;margin:0 auto;padding:22px}
  .card{background:var(--card);border-radius:22px;box-shadow:var(--shadow);padding:22px;margin-bottom:16px}
  h1{font-size:26px;font-weight:700;margin:6px 0 10px; color: #5a4628;}
  h2{font-size:18px;margin:0 0 10px;font-weight:700; color: #8a6b3f;}
  .sub{opacity:.9; font-size: 15px;}.muted{color:var(--muted);font-size:13px}.center{text-align:center}
  
  /* æŒ‰é’®ä¸èƒ¶å›Šæ ·å¼ */
  .pill{display:inline-block;background:#ffe5ec;padding:8px 12px;border-radius:999px;margin:6px 4px 0 0;font-size:13px;color: var(--pink);}
  .pill.disabled{opacity:.6;pointer-events:none;filter:grayscale(1);}
  .btn{display:inline-block;padding:10px 20px;border-radius:999px;background:var(--pink);color:#fff;font-weight:700;border:none;font-size:15px;transition:0.1s;}
  .btn:active{transform:scale(.96);}

  /* å€’è®¡æ—¶ */
  .count{display:flex;justify-content:center;gap:8px;margin:12px 0}
  .box{min-width:64px;padding:8px 10px;border-radius:12px;background:#fff5f7;border:1px solid #ffd5e0;text-align:center}
  .box b{font-size:18px;display:block;color:var(--pink)}
  .box span{font-size:12px;color:#b08d98}

  /* ===== èˆå°ï¼ˆçŒ«ï¼‰ä¼˜åŒ–ç‰ˆ ===== */
  .stage{height:280px;position:relative;overflow:hidden;margin-top:10px; cursor: pointer;}
  
  /* çŒ«å’ªå®¹å™¨ï¼šè´Ÿè´£ä½ç§» */
  .kitty-wrap{
    position:absolute;left:50%;top:56%;transform:translate(-50%,-50%);
    width:min(60vw, 280px); z-index: 2;
  }
  
  /* çŒ«å’ªå›¾ç‰‡ï¼šè´Ÿè´£å½¢å˜ï¼ˆå‘¼å¸ã€Qå¼¹ï¼‰ */
  .kitty-img{
    width:100%;height:auto; display:block;
    /* å…³é”®ï¼šå‘¼å¸æ„ŸåŠ¨ç”»ï¼Œæ¨¡æ‹Ÿç”Ÿå‘½åŠ› */
    animation: breathe 3s ease-in-out infinite;
    transform-origin: bottom center;
    /* å»ºè®®å»èƒŒæ™¯åï¼ŒæŠŠä¸‹é¢çš„åœ†è§’å’Œé˜´å½±å»æ‰ï¼Œæ•ˆæœæ›´è‡ªç„¶ã€‚å¦‚æœæ²¡å»èƒŒæ™¯ï¼Œä¿ç•™å³å¯ */
    /* border-radius:20px; box-shadow:0 10px 20px rgba(0,0,0,.1); */ 
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.15)); /* ç»™é€æ˜PNGåŠ æŠ•å½± */
  }

  .shadow{
    position:absolute;left:50%;top:80%;transform:translateX(-50%);
    width:40%;height:12px;background:rgba(0,0,0,0.15);
    border-radius:50%;filter:blur(4px); animation: shadow-breathe 3s ease-in-out infinite;
  }

  /* åŠ¨ç”»å®šä¹‰ */
  @keyframes breathe { 0%,100%{transform:scale(1,1)} 50%{transform:scale(1.03, 0.97)} } /* è½»å¾®å‹æ‰ */
  @keyframes shadow-breathe { 0%,100%{transform:translateX(-50%) scale(1); opacity: .6} 50%{transform:translateX(-50%) scale(1.05); opacity: .7} }
  
  /* åŠ¨ä½œç±»ï¼šè¦†ç›–åœ¨ kitty-wrap ä¸Š */
  .act-jump {animation: jump .6s cubic-bezier(0.17, 0.67, 0.54, 1)}
  @keyframes jump { 0%{top:56%} 50%{top:40%} 100%{top:56%} }
  
  .act-runL {animation: runL 1.2s ease-in-out}
  @keyframes runL {0%{left:70%} 50%{left:30%} 100%{left:50%}}
  
  .act-runR {animation: runR 1.2s ease-in-out}
  @keyframes runR {0%{left:30%} 50%{left:70%} 100%{left:50%}}
  
  .act-shake {animation: shake .4s ease-in-out}
  @keyframes shake {0%,100%{transform:translate(-50%,-50%) rotate(0)} 25%{transform:translate(-50%,-50%) rotate(-5deg)} 75%{transform:translate(-50%,-50%) rotate(5deg)}}

  /* èµ°è·¯æ—¶å›¾ç‰‡é™„åŠ çš„æ™ƒåŠ¨ï¼ˆWaddleï¼‰ */
  .act-runL .kitty-img, .act-runR .kitty-img { animation: waddle 0.3s infinite alternate; }
  @keyframes waddle { from{transform:rotate(-3deg)} to{transform:rotate(3deg)} }

  /* ç¿»ç‰ŒåŒºåŸŸ */
  .grid18{display:grid;grid-template-columns:repeat(3,1fr);gap:8px; margin-top:15px}
  .card3d{
    position:relative; aspect-ratio: 3/4; perspective:1000px; cursor:pointer;
    transform-style:preserve-3d; transition:transform .6s;
  }
  .card3d.flipped { transform: rotateY(180deg); }
  .face{
    position:absolute;inset:0; backface-visibility:hidden; border-radius:12px;
    display:flex;align-items:center;justify-content:center; padding:8px; text-align:center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.05); font-size: 13px; line-height: 1.4;
  }
  .front{background:#fff5f7; border: 2px solid #fff;}
  .front b{font-size:20px; color:#ff9fb8; opacity: .5;}
  .back{background:#fff; transform:rotateY(180deg); color:#555; border: 2px solid #ffe5ec; overflow:hidden;}

  /* éŸ³ä¹æ§åˆ¶ */
  .music-btn{
    position:fixed; right:20px; bottom:20px; width:44px; height:44px; 
    background:#fff; border-radius:50%; box-shadow:0 4px 12px rgba(0,0,0,0.15);
    z-index: 100; display:flex; align-items:center; justify-content:center;
    cursor: pointer; border: 2px solid #eee;
  }
  .music-btn.playing img { animation: spin 4s linear infinite; }
  @keyframes spin { to{transform:rotate(360deg)} }

  /* å¼¹å±‚ */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:20px; z-index: 99;}
  .modal.show{display:flex}
  .inner{background:#fff;border-radius:18px;max-width:320px;width:100%;padding:24px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,.2);}
</style>
</head>
<body>

<div class="wrap">
  <div class="card center">
    <div class="sub" id="hi">Hi å­¦å¦¹ï¼Œå°çŒ«æ¥å•¦ï½</div>

    <div class="stage" id="stage">
      <div class="kitty-wrap" id="kittyWrap">
        <img class="kitty-img" src="./assets/cat.png" alt="ç”Ÿæ—¥å°çŒ«">
      </div>
      <div class="shadow"></div>
    </div>

    <h1 id="title">Happy 18th Birthday ğŸ‚</h1>
    <div id="type" style="min-height:40px; font-size:15px; color:#666; margin: 0 10px;"></div>

    <div class="count" id="countdown"></div>
    
    <div style="margin-top:15px">
      <a class="pill disabled" id="eggBtn" href="./307/" target="_self">ğŸ å½©è›‹ï¼ˆè§£é”è¿›åº¦ 0/18ï¼‰</a>
    </div>
  </div>

  <div class="card">
    <h2 class="center">âœ¨ 18 ä¸ªå°å¿ƒæ„¿ & å¤¸å¤¸å¡</h2>
    <div class="center muted" style="margin-bottom:10px">ç‚¹äº®æ‰€æœ‰å¡ç‰‡ï¼Œè§£é”ç¥ç§˜ç¤¼ç‰©</div>
    
    <div class="grid18" id="grid18"></div>
    
    <div class="center" style="margin-top:20px">
      <button class="btn" id="randBtn" style="background:#d4b073">âœ¨ å¸®æˆ‘ç¿»ä¸€å¼ </button>
    </div>
  </div>

  <div class="center muted" style="margin-top:20px; opacity: .6;">Â© 2025 For You.</div>
</div>

<div class="music-btn" id="musicBtn">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="var(--pink)"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
  <audio id="bgm" loop>
    <source src="./assets/bgm.mp3" type="audio/mpeg">
  </audio>
</div>

<div class="modal" id="achieveModal">
  <div class="inner">
    <h2>ğŸ‰ æˆå°±è¾¾æˆï¼</h2>
    <p style="color:#666; margin: 15px 0;">18 å¼ å¡ç‰‡å…¨éƒ¨ç‚¹äº®å•¦<br>å¿«å»çœ‹çœ‹å°çŒ«å‡†å¤‡äº†ä»€ä¹ˆï¼Ÿ</p>
    <button class="btn" onclick="location.href='./307/'">å‰å¾€å½©è›‹æˆ¿é—´ ğŸ‘‰</button>
  </div>
</div>

<script>
  /* ===== 1. æ—¶é—´é…ç½® (è¯·ç¡®è®¤å¹´ä»½) ===== */
  // é€»è¾‘ï¼šå¦‚æœæ˜¯ä»Šå¹´12.13è¿˜æ²¡åˆ°ï¼Œå°±æ˜¯ä»Šå¹´ï¼›å¦‚æœè¿‡äº†ï¼Œå°±æ˜¯æ˜å¹´ã€‚
  const targetDate = "12-13 00:00:00";
  const now = new Date();
  const currentYear = now.getFullYear();
  // ç®€å•çš„åˆ¤å®šï¼šå¦‚æœå½“å‰æœˆä»½å¤§äº12ï¼Œæˆ–è€…(æ˜¯12æœˆä¸”è¿‡äº†13å·)ï¼Œåˆ™å¹´ä»½+1
  // è¿™é‡Œç›´æ¥å†™æ­» 2025 ä¹Ÿå¯ä»¥ï¼Œæˆ–è€…ç”¨åŠ¨æ€é€»è¾‘
  let birthdayStr = currentYear + "-" + targetDate;
  if(now > new Date(birthdayStr.replace(/-/g,'/'))) {
      birthdayStr = (currentYear+1) + "-" + targetDate;
  }
  // ä¿®æ­£ï¼šç”¨æˆ·æŒ‡å®šäº† 12æœˆ13æ—¥ã€‚
  const BIRTHDAY = birthdayStr; 

  /* ===== 2. æ–‡æ¡ˆ (è¯·åœ¨æ­¤å¤„ä¿®æ”¹ä½ çš„18æ¡æ–‡æ¡ˆ) ===== */
  const WISHES = [
    "æ„¿ä½ æ°¸è¿œè¢«æ¸©æŸ”ä»¥å¾…", "è€ƒè¯•é¡ºåˆ©ï¼Œä¸æŒ‚ç§‘", "æ¯å¤©éƒ½èƒ½ç¡ä¸ªå¥½è§‰",
    "åƒä¸èƒ–ä½“è´¨ Get", "å¿«ä¹æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›", "å¶å°”è¿·è·¯ä¹Ÿæ²¡å…³ç³»",
    "æƒ³å»çš„åœ°æ–¹éƒ½èƒ½å»", "é‡è§çš„æ‰€æœ‰äººéƒ½å–„è‰¯", "å‘é‡æƒŠäººï¼Œå‘é™…çº¿åšæŒº",
    "æ‹¥æœ‰è¶…èƒ½åŠ›ï¼šç™¾æ¯’ä¸ä¾µ", "ä¿æŒå¥½å¥‡ï¼Œä¿æŒçƒ­çˆ±", "ä»Šå¤©çš„ä½ æ¯”æ˜¨å¤©æ›´å¯çˆ±",
    "ä¸‹é›¨å¤©éƒ½æœ‰äººé€ä¼", "è¢«å–œæ¬¢çš„äººåšå®šé€‰æ‹©", "æ‰€æœ‰çƒ¦æ¼éƒ½åªæ˜¯æš‚æ—¶çš„",
    "æ—¢è§å›å­ï¼Œäº‘èƒ¡ä¸å–œ", "å¹³å®‰å–œä¹ï¼Œä¸‡äº‹èƒœæ„", "åå…«å²ç”Ÿæ—¥å¿«ä¹ï¼"
  ];

  /* ===== 3. æ ¸å¿ƒé€»è¾‘ ===== */
  const kittyWrap = document.getElementById('kittyWrap');
  const stage = document.getElementById('stage');
  const musicBtn = document.getElementById('musicBtn');
  const bgm = document.getElementById('bgm');
  
  // éŸ³ä¹æ’­æ”¾é€»è¾‘
  let musicPlaying = false;
  function toggleMusic(){
    if(musicPlaying){ bgm.pause(); musicBtn.classList.remove('playing'); }
    else { bgm.play(); musicBtn.classList.add('playing'); }
    musicPlaying = !musicPlaying;
  }
  musicBtn.addEventListener('click', toggleMusic);
  // è§¦æ‘¸å±å¹•ä»»æ„ä½ç½®è‡ªåŠ¨å°è¯•æ’­æ”¾ä¸€æ¬¡
  document.body.addEventListener('click', function firstPlay(){
    if(!musicPlaying){ toggleMusic(); }
    document.body.removeEventListener('click', firstPlay);
  }, {once:true});

  // çŒ«å’ªäº¤äº’
  function act(clsName){
    kittyWrap.classList.add(clsName);
    setTimeout(()=> kittyWrap.classList.remove(clsName), 1200);
  }
  stage.addEventListener('click', ()=>{
    const acts = ['act-jump', 'act-runL', 'act-runR', 'act-shake'];
    const random = acts[Math.floor(Math.random()*acts.length)];
    act(random);
    // ç®€å•çš„éœ‡åŠ¨åé¦ˆ
    if(navigator.vibrate) navigator.vibrate(20);
  });

  // ç¿»ç‰Œé€»è¾‘
  const grid = document.getElementById('grid18');
  const eggBtn = document.getElementById('eggBtn');
  const STORAGE_KEY = 'bc_flipped_18'; // å­˜å‚¨key
  
  // è¯»å–å·²ç¿»å¼€çš„
  let flippedSet = new Set();
  try{ flippedSet = new Set(JSON.parse(localStorage.getItem(STORAGE_KEY)) || []); }catch{}

  function renderGrid(){
    grid.innerHTML = '';
    let count = 0;
    WISHES.forEach((text, idx)=>{
      const isFlipped = flippedSet.has(idx);
      if(isFlipped) count++;
      
      const item = document.createElement('div');
      item.className = `card3d ${isFlipped?'flipped':''}`;
      item.innerHTML = `
        <div class="face front"><b>${idx+1}</b></div>
        <div class="face back">${text}</div>
      `;
      item.onclick = () => toggleCard(item, idx);
      grid.appendChild(item);
    });
    updateStatus(count);
  }
  
  function toggleCard(el, idx){
    if(el.classList.contains('flipped')){
       // ä¹Ÿå¯ä»¥è®¾è®¡æˆç¿»å¼€å°±ä¸èƒ½ç›–å›å»ï¼Œè¿™é‡Œä¿ç•™å¯ç›–å›
       // el.classList.remove('flipped');
       // flippedSet.delete(idx);
    } else {
       el.classList.add('flipped');
       flippedSet.add(idx);
    }
    localStorage.setItem(STORAGE_KEY, JSON.stringify([...flippedSet]));
    updateStatus(flippedSet.size);
  }

  function updateStatus(n){
    eggBtn.textContent = n>=18 ? "ğŸ å½©è›‹å·²è§£é” (ç‚¹æˆ‘è¿›å…¥)" : `ğŸ å½©è›‹ï¼ˆè§£é”è¿›åº¦ ${n}/18ï¼‰`;
    if(n>=18){
      eggBtn.classList.remove('disabled');
      // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®Œæˆ
      if(!localStorage.getItem('bc_egg_shown')){
        document.getElementById('achieveModal').classList.add('show');
        localStorage.setItem('bc_egg_shown', '1');
      }
    }
  }

  document.getElementById('randBtn').onclick = () => {
    // æ‰¾ä¸€ä¸ªæ²¡ç¿»å¼€çš„
    const unflip = [];
    WISHES.forEach((_,i)=>{ if(!flippedSet.has(i)) unflip.push(i); });
    if(unflip.length > 0){
      const lucky = unflip[Math.floor(Math.random()*unflip.length)];
      // æ¨¡æ‹Ÿç‚¹å‡»
      grid.children[lucky].click();
      grid.children[lucky].scrollIntoView({behavior:'smooth', block:'center'});
    } else {
      alert("å…¨éƒ½ç¿»å¼€å•¦ï¼å¿«å»ç‚¹å½©è›‹å§ï¼");
    }
  };

  /* æ‰“å­—æœºæ•ˆæœ */
  const msg = "ä»Šå¤©æ˜¯ä½ çš„18å²ç”Ÿæ—¥ã€‚ç¿»å¼€ä¸‹é¢ 18 å¼ å¡ç‰‡ï¼Œæ”¶é›†å°çŒ«çš„ç¥ç¦å§ï¼";
  const typeEl = document.getElementById('type');
  let typeI = 0;
  function typeWriter(){
    if(typeI < msg.length){
      typeEl.textContent += msg.charAt(typeI);
      typeI++;
      setTimeout(typeWriter, 50);
    }
  }
  setTimeout(typeWriter, 500);

  /* å€’è®¡æ—¶ */
  function tick(){
    const t = Date.parse(BIRTHDAY) - Date.now();
    const el = document.getElementById('countdown');
    if(t<0){
      el.innerHTML = "<div class='box'><b>ğŸ‚</b>Happy Birthday!</div>";
      return;
    }
    const d=Math.floor(t/86400000), h=Math.floor((t%86400000)/3600000), 
          m=Math.floor((t%3600000)/60000), s=Math.floor((t%60000)/1000);
    el.innerHTML = `
      <div class="box"><b>${d}</b><span>DAYS</span></div>
      <div class="box"><b>${h}</b><span>HOURS</span></div>
      <div class="box"><b>${m}</b><span>MIN</span></div>
      <div class="box"><b>${s}</b><span>SEC</span></div>
    `;
  }
  setInterval(tick, 1000); tick();

  renderGrid();
</script>
</body>
</html>
