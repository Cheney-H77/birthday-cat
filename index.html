<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover" />
  <meta property="og:title" content="ç”Ÿæ—¥æƒŠå–œ | å€’è®¡æ—¶">
  <meta property="og:description" content="æ¸©æŸ”ä¸å¹¼ç¨šçš„å°å°æƒŠå–œï¼Œé€ç»™å¾ˆé‡è¦çš„ä½ ">
  <meta property="og:image" content="./assets/preview.jpg">
  <link rel="icon" href="./assets/favicon.ico">
  <title>ç”Ÿæ—¥æƒŠå–œ | å€’è®¡æ—¶</title>
  <style>
    :root{
      --milk:#fff9f3; --tea:#222; --gray:#7a7a7a;
      --gold:#d4b073; --pink:#ff5c8a;
      --radius-lg:20px; --shadow:0 10px 22px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--milk);color:var(--tea);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif}
    h1{font-size:28px;font-weight:800;text-align:center;margin:24px 0 12px}
    .wrap{max-width:980px;margin:0 auto;padding:12px 16px 48px}
    .subtle{color:var(--gray);font-size:14px}

    /* é¡¶éƒ¨æ ‡é¢˜åŒº */
    .title-line{display:flex;align-items:center;justify-content:center;gap:8px}

    /* ç¤¼ç‰©ç›’ */
    .gift-area{display:flex;flex-direction:column;align-items:center;margin:8px 0 12px}
    .gift{width:210px;height:210px;border-radius:24px;box-shadow:var(--shadow);position:relative;overflow:hidden;cursor:pointer;transform-origin:50% 60%;
      animation:breath 2.6s ease-in-out infinite}
    .gift .lid{position:absolute;left:0;top:0;width:100%;height:35%;background:var(--pink);border-top-left-radius:24px;border-top-right-radius:24px;transform-origin:50% 100%;transition:transform .5s ease}
    .gift .box{position:absolute;left:0;top:35%;width:100%;height:65%;background:#d2ae79;border-bottom-left-radius:24px;border-bottom-right-radius:24px}
    .gift.open .lid{transform:rotateX(65deg)}
    @keyframes breath{0%,100%{transform:scale(1)}50%{transform:scale(.985)}}

    /* å€’è®¡æ—¶ & ç§°å‘¼ */
    .hello{margin:6px 0 18px;text-align:center}
    .hello strong{font-weight:800}

    /* å°çŒ«èˆå° */
    .stage{display:flex;justify-content:center;margin:6px 0 12px}
    .cat-card{width:260px;height:160px;background:#fff;border-radius:20px;box-shadow:var(--shadow);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .cat{width:120px;height:120px;border-radius:16px;background:#f7efe8 url('./assets/cat.png') center/cover no-repeat;box-shadow:inset 0 0 0 1px rgba(0,0,0,.03)}
    .shadow{position:absolute;bottom:12px;left:50%;width:120px;height:14px;border-radius:50%;background:rgba(0,0,0,.12);filter:blur(4px);transform:translateX(-50%) scale(1);transition:transform .25s}
    .cat.shake{animation:shake .45s ease}
    @keyframes shake{10%,90%{transform:translateX(-2px)}20%,80%{transform:translateX(4px)}30%,50%,70%{transform:translateX(-6px)}40%,60%{transform:translateX(6px)}}
    .cat.spin{animation:spin 1.2s ease both}
    @keyframes spin{to{transform:rotate(360deg)}}
    .cat.jump{animation:jump .6s ease both}
    @keyframes jump{40%{transform:translateY(-26px)}100%{transform:translateY(0)}}
    .cat.runL{animation:runL 1.2s ease both}
    .cat.runR{animation:runR 1.2s ease both}
    @keyframes runL{0%{transform:translateX(0)}70%{transform:translateX(-120px)}100%{transform:translateX(-120px)}} 
    @keyframes runR{0%{transform:translateX(0)}70%{transform:translateX(120px)}100%{transform:translateX(120px)}}
    .cat.sleepy{filter:grayscale(.2) brightness(.96)}
    .paw{position:absolute;width:22px;height:22px;opacity:.85;background:
      radial-gradient(circle at 50% 70%, #d4b073 38%, transparent 39%),
      radial-gradient(circle at 28% 25%, #d4b073 34%, transparent 35%),
      radial-gradient(circle at 72% 25%, #d4b073 34%, transparent 35%),
      radial-gradient(circle at 28% 75%, #d4b073 34%, transparent 35%),
      radial-gradient(circle at 72% 75%, #d4b073 34%, transparent 35%);
      border-radius:50%; pointer-events:none; animation:pawfade 1.6s ease forwards}
    @keyframes pawfade{to{opacity:0;transform:translateY(8px)}}
    .heart{position:absolute;width:10px;height:10px;background:var(--pink);transform:rotate(45deg);animation:floatUp 1s ease-out forwards;opacity:.9}
    .heart:before,.heart:after{content:"";position:absolute;width:10px;height:10px;background:var(--pink);border-radius:50%}
    .heart:before{left:-5px;top:0}.heart:after{left:0;top:-5px}
    @keyframes floatUp{to{transform:translateY(-60px) rotate(45deg);opacity:0}}

    /* è¿›åº¦æ¡ä¸è®¡æ•° */
    .progress-wrap{margin:8px auto 24px;max-width:1240px;padding:0 16px}
    .bar{height:10px;background:#888;border-radius:6px;overflow:hidden}
    .bar > i{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--gold),#e4c58c)}

    /* å¡ç‰‡ 12 å¼  */
    .grid{display:grid;grid-template-columns:repeat(4,minmax(180px,1fr));gap:14px;justify-items:center}
    .card{width:180px;height:200px;perspective:1000px}
    .card-inner{position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform .6s}
    .card.flipped .card-inner{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;border-radius:18px;box-shadow:var(--shadow);display:flex;align-items:center;justify-content:center;padding:16px;backface-visibility:hidden}
    .front{background:linear-gradient(180deg,#fff,#f9efe8)}
    .front .front-cat{width:88px;height:88px;background:url('./assets/cat.png') center/cover no-repeat;opacity:.9;filter:saturate(.9)}
    .back{transform:rotateY(180deg);background:#fff;line-height:1.8;background-image:
      radial-gradient(#f2e5d1 1px,transparent 1px);
      background-size:14px 14px}
    .back .text{font-size:14px;padding:8px 6px;text-align:center}

    /* å½©è›‹æŒ‰é’® */
    .egg-cta{display:flex;justify-content:center;margin:22px 0}
    .btn{appearance:none;border:0;border-radius:999px;background:#e9d6b3;color:#6b5835;padding:10px 16px;font-weight:700;box-shadow:var(--shadow);transform:translateZ(0);cursor:not-allowed}
    .btn.enabled{background:linear-gradient(180deg,#ffd6e3,#ffb2c8);color:#7a2141;cursor:pointer}
    .btn:active{transform:scale(.97)}

    /* å¼¹å±‚ */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.36);display:none;align-items:center;justify-content:center}
    .overlay.show{display:flex}
    .dialog{background:#fff;border-radius:18px;box-shadow:var(--shadow);padding:18px 20px;max-width:320px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="title-line">ğŸ‚ <span id="title">å€’è®¡æ—¶</span> ğŸ‚</h1>

    <div class="gift-area">
      <div id="gift" class="gift" aria-label="ç¤¼ç‰©ç›’ï¼ˆç‚¹å‡»å¼€å¯ï¼‰">
        <div class="lid"></div><div class="box"></div>
      </div>
    </div>

    <div class="hello">
      <div id="helloText">å°å–µï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ <span class="subtle" id="fromText">â€”â€” æ¥è‡ªé»„å°”å°˜</span></div>
      <div class="subtle" id="countdown">â€”â€” 2025-12-13 00:00:00 â€”â€”</div>
    </div>

    <div class="stage">
      <div class="cat-card" id="stage">
        <div id="cat" class="cat" role="img" aria-label="å°çŒ«"></div>
        <div id="catShadow" class="shadow"></div>
      </div>
    </div>

    <div class="hello"><span id="progressText">å·²è§£é” 0/12</span></div>
    <div class="progress-wrap">
      <div class="bar"><i id="barFill"></i></div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="egg-cta">
      <button id="eggBtn" class="btn" disabled>å½©è›‹æœªè§£é”</button>
    </div>
  </div>

  <!-- å¼¹å±‚ -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div class="dialog"><div id="dialogText">æˆå°±è§£é”ï¼</div></div>
  </div>

  <script>
  ;(function QueryAndOG(){
    const q = new URLSearchParams(location.search);
    const to = q.get('to') || 'å°å–µï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼';
    const from = q.get('from') || 'æ¥è‡ªé»„å°”å°˜';
    document.getElementById('helloText').firstChild.nodeValue = to + ' ';
    document.getElementById('fromText').textContent = 'â€”â€” ' + from;

    // åŠ¨æ€ OGï¼ˆå¾®ä¿¡å¤šæ•°åœºæ™¯è¯»å–é¦–å›¾å³å¯ï¼Œç•™ä½œå…¼å®¹ï¼‰
    const ogTitle = document.querySelector('meta[property="og:title"]');
    if (ogTitle) ogTitle.setAttribute('content', 'é€ç»™ ' + to + ' çš„ç”Ÿæ—¥å°æƒŠå–œ');
  })();

  ;(function CountdownModule(){
    const target = new Date('2025/12/13 00:00:00'); // iOS å…¼å®¹å†™æ³•
    const cdEl = document.getElementById('countdown');
    const titleEl = document.getElementById('title');

    function pad(n){return n<10?'0'+n:n}
    function tick(){
      const now = new Date();
      let ms = target - now;
      if (ms <= 0){
        titleEl.textContent = 'Happy 18! ğŸ‰';
        cdEl.textContent = 'å°±æ˜¯ä»Šå¤©ï¼ç”Ÿæ—¥å¿«ä¹ï½';
        // ç”Ÿæ—¥å½“å¤©å½©å¸¦åŠ å€ + å°çŒ«è¡¨æ¼”
        Confetti.launch(72);
        CatModule.randomAction();
        setTimeout(()=>CatModule.randomAction(), 1000);
        return;
      }
      const d = Math.floor(ms/86400000); ms%=86400000;
      const h = Math.floor(ms/3600000);  ms%=3600000;
      const m = Math.floor(ms/60000);    ms%=60000;
      const s = Math.floor(ms/1000);
      cdEl.textContent = `è·ç¦» 2025-12-13 è¿˜æœ‰ ${d}å¤© ${pad(h)}:${pad(m)}:${pad(s)}`;
      requestAnimationFrame(()=>setTimeout(tick,1000));
    }
    tick();
  })();

  ;const Storage = {
    get(key, fallback){ try{ const v = localStorage.getItem(key); return v?JSON.parse(v):fallback }catch(e){ return fallback } },
    set(key, val){ try{ localStorage.setItem(key, JSON.stringify(val)) }catch(e){} }
  };

  ;const Confetti = (function(){
    function once(n=36){
      const frag = document.createDocumentFragment();
      for(let i=0;i<n;i++){
        const d = document.createElement('div');
        d.style.cssText = `
          position:fixed;left:${Math.random()*100}vw;top:-10px;width:8px;height:14px;border-radius:2px;
          background:${i%3? '#ffb2c8' : '#d4b073'};transform:rotate(${Math.random()*360}deg);
          animation:fall ${2+Math.random()*1.2}s ease-out forwards;`;
        d.style.zIndex=9999;
        frag.appendChild(d);
      }
      document.body.appendChild(frag);
      setTimeout(()=>document.querySelectorAll('@keyframes').forEach?.(()=>{}),3000);
    }
    const style = document.createElement('style');
    style.textContent = `@keyframes fall{to{transform:translateY(102vh) rotate(720deg)}}`;
    document.head.appendChild(style);
    return { launch: once }
  })();

  ;const GiftBoxModule = (function(){
    const el = document.getElementById('gift');
    el.addEventListener('click', ()=>{
      el.classList.add('open');
      Confetti.launch(36);
      setTimeout(()=>location.href='./307/', 1200); // 1.2s è·³è½¬
    });
  })();

  ;const CatModule = (function(){
    const cat = document.getElementById('cat');
    const shadow = document.getElementById('catShadow');
    let pressTimer = null, pressing=false;

    function makeHeart(x,y){
      for(let i=0;i<6+Math.floor(Math.random()*5);i++){
        const h = document.createElement('div'); h.className='heart';
        const dx=(Math.random()*40-20), dy=(Math.random()*10);
        h.style.left = (x+dx)+'px'; h.style.top=(y+dy)+'px';
        document.body.appendChild(h);
        setTimeout(()=>h.remove(),1000);
      }
    }
    function paws(){
      const stage = document.getElementById('stage');
      const rect = stage.getBoundingClientRect();
      const num = 3+Math.floor(Math.random()*3);
      for(let i=0;i<num;i++){
        const p = document.createElement('div'); p.className='paw';
        p.style.left = (rect.left + 50 + Math.random()*(rect.width-100))+'px';
        p.style.top  = (rect.top  + rect.height-46 - Math.random()*30)+'px';
        document.body.appendChild(p);
        setTimeout(()=>p.remove(),1600);
      }
    }
    function run(dir){
      cat.classList.add(dir?'runR':'runL'); shadow.style.transform='translateX(-50%) scale(.7)'; paws();
      setTimeout(()=>{ cat.classList.remove('runR','runL'); shadow.style.transform='translateX(-50%) scale(1)'; },1200);
    }
    function randomAction(){
      const acts=['spin','jump','runL','runR'];
      const a=acts[Math.floor(Math.random()*acts.length)];
      if(a==='spin'||a==='jump'){ cat.classList.add(a); setTimeout(()=>cat.classList.remove(a),1200); }
      else run(a==='runR');
      schedule();
    }
    function schedule(){
      const t=8000+Math.random()*4000; // 8-12s
      setTimeout(randomAction,t);
    }
    cat.addEventListener('click', (e)=>{
      cat.classList.add('shake'); setTimeout(()=>cat.classList.remove('shake'),450);
      makeHeart(e.clientX,e.clientY-20);
    });
    function startPress(){
      pressing=true; pressTimer = setTimeout(()=>{ cat.classList.add('sleepy') },800);
    }
    function endPress(){
      pressing=false; clearTimeout(pressTimer); cat.classList.remove('sleepy');
    }
    cat.addEventListener('mousedown',startPress); cat.addEventListener('touchstart',startPress,{passive:true});
    ['mouseup','mouseleave','touchend','touchcancel'].forEach(evt=>cat.addEventListener(evt,endPress));
    schedule();
    return { randomAction };
  })();

  ;const CardsModule = (function(){
    const grid = document.getElementById('grid');
    const filled = new Set(Storage.get('bc_flipped_set', []));
    const progressText = document.getElementById('progressText');
    const bar = document.getElementById('barFill');
    const total = 12;

    const texts = [
      'æ„¿ä½ ç©¿è¿‡äººæµ·ï¼Œä»è§‰äººé—´å€¼å¾—ã€‚',
      'é•¿è·¯æœ‰ç¯ï¼Œé£é›¨æœ‰ä½ ã€‚',
      'æ­¤å¿ƒå…‰æ˜ï¼Œä¸‡ç‰©å¯çˆ±ã€‚',
      'æ„¿ä½ æ‰€åˆ°ä¹‹å¤„ï¼Œéåœ°æ¸©æŸ”ã€‚',
      'åœ¨æ‰€æœ‰æ˜Ÿè¾°é‡Œï¼Œä½ æœ€ç‰¹åˆ«ã€‚',
      'æŠŠå¿«ä¹æ”¾å¿ƒé‡Œï¼ŒæŠŠä¸–ç•Œæ”¾å¿ƒä¸Šã€‚',
      'ç”Ÿæ´»ä¸å¿…å¤ªç”¨åŠ›ï¼ŒæŠ¬å¤´ä¼šæœ‰æ˜Ÿå…‰ã€‚',
      'æ„¿ä½ æœ‰æƒŠæ…Œå¤±æªçš„å‹‡æ°”ï¼Œä¹Ÿæœ‰ä»å®¹ä¸è¿«çš„åº•æ°”ã€‚',
      'è¦å’Œæœ‰è¶£çš„äººï¼Œåšæ¸©æŸ”çš„äº‹ã€‚',
      'æ„¿ä½ è¢«è¿™ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ã€‚',
      'æ—¢è§å›å­ï¼Œäº‘èƒ¡ä¸å–œ',
      'æ—¢è§ä½³äººï¼Œä½•å…¶ä¸æ‚¦'
    ];

    function render(){
      grid.innerHTML='';
      for(let i=0;i<total;i++){
        const card = document.createElement('div'); card.className='card'; card.dataset.idx=i;
        if(filled.has(i)) card.classList.add('flipped');
        card.innerHTML = `
          <div class="card-inner">
            <div class="face front"><div class="front-cat" aria-hidden="true"></div></div>
            <div class="face back"><div class="text">${texts[i]}</div></div>
          </div>`;
        card.addEventListener('click', ()=>flip(i,card));
        grid.appendChild(card);
      }
      updateBar();
    }
    function flip(i,card){
      if(!filled.has(i)){ filled.add(i); Storage.set('bc_flipped_set', Array.from(filled)); }
      card.classList.add('flipped'); updateBar();
    }
    function updateBar(){
      const n = filled.size;
      progressText.textContent = `å·²è§£é” ${n}/${total}`;
      bar.style.width = (n/total*100)+'%';
      if(n===total){ EggButton.enable(); showModal('æˆå°±è§£é”ï¼šå½©è›‹å·²å¯è¿›å…¥ï¼'); Storage.set('bc_egg_unlocked', true); }
    }
    render();
    return { render };
  })();

  ;const EggButton = (function(){
    const btn = document.getElementById('eggBtn');
    function enable(){
      btn.disabled=false; btn.classList.add('enabled'); btn.textContent='å»çœ‹çœ‹å½©è›‹';
      btn.addEventListener('click',()=>location.href='./307/');
    }
    if(Storage.get('bc_egg_unlocked', false)) enable();
    return { enable };
  })();

  ;(function Modal(){
    const overlay = document.getElementById('overlay');
    overlay.addEventListener('click',()=>overlay.classList.remove('show'));
    window.showModal = function(text){
      document.getElementById('dialogText').textContent = text;
      overlay.classList.add('show');
      setTimeout(()=>overlay.classList.remove('show'), 1600);
    }
  })();
  </script>
</body>
</html>


